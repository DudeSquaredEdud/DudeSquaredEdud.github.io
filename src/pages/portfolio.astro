---
import Layout from "../layouts/Layout.astro";
import PortfolioCover from "../components/portfolio/PortfolioCover.astro";
import PortfolioBio from "../components/portfolio/PortfolioBio.astro";
import PortfolioProjects from "../components/portfolio/PortfolioProjects.astro";
import PortfolioProjectDetails from "../components/portfolio/PortfolioProjectDetails.astro";
import "../components/portfolio/PortfolioStyles.css";
import { getCollection } from "astro:content";

// Get bio content
const bioEntries = await getCollection("bio");
const bioContent = bioEntries[0]?.body || '';

// Get all portfolio projects from content collection
const projects = (await getCollection("portfolio")).map(project => ({
  title: project.data.title,
  category: project.data.category,
  imageSrc: project.data.imageSrc,
  content: project.body,
  tags: project.data.tags,
  link: project.data.link
}));

const projectDetails = (await getCollection("projectDetails")).map(project => ({
  id: project.data.projectId,
  title: project.data.title,
  lead: project.data.lead,
  content: project.body,
}));
---

<Layout
  title="Portfolio - Ashton Andrepont"
  description="Educational Technology Portfolio - From EdTech Victim to EdTech Innovator"
>
  <PortfolioCover
    title="Ashton Andrepont"
    subtitle="Human-Centered Technology Developer"
    tagline=""
  />

  <PortfolioBio bioContent={bioContent} />

  <PortfolioProjects projects={projects} />

  <hr />

  {projectDetails.map(detail => (
    <PortfolioProjectDetails
      id={detail.id}
      title={detail.title}
      lead={detail.lead}
      content={detail.content}
    />
  ))}
</Layout>
